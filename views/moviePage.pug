include navBar.pug
html
  head
    link(rel='stylesheet' type='text/css' href='css/moviePage.css')
    script(src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous")
    script.

        likeStatus="#{movieLikeStatus}";

        function sendData(sendMovie, likeOrDislike){
            var xhttp = new XMLHttpRequest();

            xhttp.open("POST", "likeOrDislike", true);
            xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhttp.send('movieName=' + sendMovie + '&likedOrDisliked=' + likeOrDislike);
        }

        function fillLike(sendMovie){
            var thumbsUp = document.getElementById('thumbsUp');
            var thumbsDown = document.getElementById('thumbsDown');
            

            if(thumbsDown.getAttribute('src') == 'images/thumb-unfilled.png' && thumbsUp.getAttribute('src') == 'images/thumb-unfilled.png'){
                thumbsUp.src = 'images/thumb-filled.png';
                sendData(sendMovie, "liked")
            }else if(thumbsUp.getAttribute('src') == 'images/thumb-filled.png'){
                thumbsUp.src = 'images/thumb-unfilled.png';
                sendData(sendMovie, "neutral")
            }else if(thumbsDown.getAttribute('src') == 'images/thumb-filled.png' && thumbsUp.getAttribute('src') == 'images/thumb-unfilled.png'){
                thumbsUp.src = 'images/thumb-filled.png';
                thumbsDown.src = 'images/thumb-unfilled.png';
                sendData(sendMovie, "liked")
            }
        }

        function fillDislike(sendMovie){
            var thumbsUp = document.getElementById('thumbsUp');
            var thumbsDown = document.getElementById('thumbsDown');

            if(thumbsUp.getAttribute('src') == 'images/thumb-unfilled.png' && thumbsDown.getAttribute('src') == 'images/thumb-unfilled.png'){
                thumbsDown.src = 'images/thumb-filled.png';
                sendData(sendMovie, "disliked")
            }else if(thumbsDown.getAttribute('src') == 'images/thumb-filled.png'){
                thumbsDown.src = 'images/thumb-unfilled.png';
                sendData(sendMovie, "neutral")
            }else if(thumbsUp.getAttribute('src') == 'images/thumb-filled.png' && thumbsDown.getAttribute('src') == 'images/thumb-unfilled.png'){
                thumbsDown.src = 'images/thumb-filled.png';
                thumbsUp.src = 'images/thumb-unfilled.png';
                sendData(sendMovie, "disliked")
            }        
        }

        function fillOrNot(obj){
            var thumbsUp = document.getElementById('thumbsUp');
            var thumbsDown = document.getElementById('thumbsDown');
            console.log("This movie is " + obj);

            if(obj == "liked"){
                console.log("Movie is liked!");
                thumbsUp.src = 'images/thumb-filled.png';
            }else if(obj == "disliked"){
                console.log("Movie is disliked!");
                thumbsDown.src = 'images/thumb-filled.png';
            }
        }

        $( document ).ready(function() {
                console.log( "ready!" );
                fillOrNot(likeStatus);
            });   

  body.background
    +navBarSend(username)
    .grid
        div.movieImageDiv(style= "background: url(images/" + movieImageName + "); background-repeat: no-repeat; background-size: cover;")
        div.infoDiv    
            div.movieTitleDiv #{movieName}
            div.movieRatingDiv
                br
                a(href= "play-movie?" + movieName)
                    button.playBtn Play
                img#thumbsUp.thumbImage.rotate180(src='images/thumb-unfilled.png' width='40px' onclick='fillLike('+'"'+movieName+'"'+')')
                span#likeText LIKE
                img#thumbsDown.thumbImage(src='images/thumb-unfilled.png' width='40px' onclick='fillDislike('+'"'+movieName+'"'+')')
                span#dislikeText(onLoad) DISLIKE
                br
                br
                span.year #{releaseYear} |
                span.time #{runtime} mins |
                span.rating #{rating}
                br
                br
                for cat, i in category
                    span.genre #{cat} 
                br
                br
                span.description #{description}
    include footer.pug
